{% extends 'base.html'%}
{% block title %}Event details{% endblock %}
{% block body %}
<style>
    .body {
        position: relative;
        width : 100%;
        height: 100%;
    }
</style>

<div class="col-sm-12">
    <h1>{{ event.name }}</h1>
</div>

<div class="events-container container-fluid">
    <table>
        <tr>
            <th style="width: 30%;"><img src="{{ event.image.url }}" class="img-responsive"></th>
            <th class="text-left" style="padding-left: 40px;">
                <h4>Date: {{ event.date }}</h4>
                <h4>Spots: {{ event.spots }}</h4>
                <h4>Location: {{ event.location }}</h4>
                <h4>Price: {{ event.price }}</h4>
                <h4>Enrollment begins: {{ event.enrollment_begin }}</h4>
                <h4>Enrollment ends: {{ event.enrollment_end }}</h4>
                <h4>Owner: {{ event.owner.username }}</h4>
                <h4>Description:</h4>
                <p>{{ event.description }}</p>
                {% if user == 'owner' or user == 'enrolled' %}
                <h4>Participants:</h4>
                <p>
                {% for user in event.participants.all %}
                <li>{{ user.username }}</li>
                {% endfor %}
                </p>
                {% if user == 'owner' %}
                    <a href="{% url 'edit_event' event.id %}" class="btn btn-primary active" role="button">Edit event</a>
                    <form action="{% url 'delete' event.id %}" method="post" style="display: inline;">
                        {% csrf_token %}
                        <input type="hidden" name="event_id" value="{{ event.id }}"/>
                        <button type="submit" class="btn btn-default btn-sm">
                            <span class="glyphicon glyphicon-trash"></span>
                        </button>
                    </form>
                {% endif %}
            </th>
            <th style="width:20%;padding-left: 20px;"> <img src="{{ event.qr_code.url }}" class="img-responsive"> </th>
        </tr>
    </table>
    <table>
        {% with comments.count as total_comments %}
        <h4>
            {{ total_comments }} comment{{ total_comments|pluralize:"s" }}
        </h4>
        {% endwith %}
        {% for comment in comments %}
        <div class="well comment">
            <p class="info">
                {{ comment.name }},
                {{ comment.created }}
            </p>
            {{ comment.body|linebreaks }}
        </div>
        {% empty %}
        <p>No comments yet.</p>
        {% endfor %}
        <h4>Add new comment</h4>
        <form action="." method="post">
            {{ comment_form.as_p }}
            {% csrf_token %}
            <p><input style="background-color: #4CAF50;border: none;" class="btn btn-primary btn-sm" type="submit" value="Add comment"></p>
        </form>
        {% endif %}
    </table>
</div>

{% endblock %}
